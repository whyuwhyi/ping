# Simple Ping - ICMP实验程序

## 项目简介

这是一个基于ICMP协议的简单ping程序实现，支持IPv4和IPv6。本程序是ICMP实验的基础版本，参照Unix下的ping程序实现了基本的ping功能。

## 当前功能

- 支持IPv4和IPv6协议
- 基本的ICMP echo请求和回复处理
- RTT（往返时间）计算和显示
- 详细模式（-v）显示更多诊断信息
- 自动解析主机名和IP地址

## 编译和运行

### 编译

```bash
make
```

### 运行

```bash
# 需要root权限运行（因为使用原始套接字）
sudo ./ping hostname
sudo ./ping -v hostname  # 详细模式
```

## 使用方法

```
usage: ping [ -v ] <hostname>
```

**参数说明：**

- `-v`: 详细模式，显示更多的调试信息
- `hostname`: 目标主机名或IP地址

## 代码结构

- `ping.c`: 主程序文件，包含核心ping功能实现
- `ping.h`: 头文件，包含必要的系统头文件和结构定义
- `Makefile`: 编译配置文件

## 24种功能扩展方案

### 基本功能扩展

1. **-b 广播ping支持**
   - 允许ping一个广播地址
   - 仅适用于IPv4
   - 实现网络广播包发送和接收

2. **-c count 包数量控制**
   - 发送指定数目的包后停止
   - 替代无限循环发送模式
   - 支持统计发送成功/失败数量

3. **-h 帮助信息**
   - 显示详细的使用帮助
   - 列出所有支持的选项
   - 提供使用示例

4. **-i interval 间隔时间设置**
   - 设定发送包的时间间隔（秒）
   - 支持浮点数间隔（如0.5秒）
   - 可配置不同的发送频率

5. **-q 安静模式**
   - 不显示每个收到包的详细信息
   - 仅在结束时显示汇总统计
   - 减少输出噪音

6. **-s packetsize 数据包大小设置**
   - 指定发送的数据字节数
   - 支持不同大小的测试包
   - 验证MTU和分片处理

7. **-t ttl TTL值设置**
   - 设置IP包的TTL值
   - 仅适用于IPv4
   - 用于路径跟踪和网络诊断

### 传统Unix ping功能扩展

8. **-W timeout 超时设置**
   - 设置等待每个回复的超时时间（毫秒）
   - 适应不同网络环境
   - 控制等待时间

9. **-f 洪水ping模式**
   - 快速连续发送包（flood ping）
   - 网络压力测试
   - 需要特权用户权限

10. **-n 数字输出模式**
    - 不解析主机名，直接显示IP地址
    - 避免DNS查询延迟
    - 加快输出速度

11. **-p pattern 填充模式**
    - 使用指定的16进制模式填充数据包
    - 测试网络设备对特定数据模式的处理
    - 网络设备兼容性测试

12. **-r 绕过路由表**
    - 直接从本地接口发送
    - 测试本地网络连通性
    - 绕过路由配置问题

13. **-R 记录路由**
    - 记录数据包的路由路径
    - 显示经过的路由器IP地址
    - IPv4路径追踪功能

14. **-l preload 预加载模式**
    - 快速发送指定数量的包然后正常发送
    - 测试网络突发处理能力
    - 需要特权用户权限

15. **-w deadline 运行时间限制**
    - 设置ping程序运行的总时间（秒）
    - 超时后自动退出
    - 长期监控的时间控制

16. **-d 调试模式**
    - 在套接字上设置SO_DEBUG选项
    - 显示更详细的调试信息
    - 网络问题诊断

### IPv6和协议相关功能

17. **-4 强制IPv4模式**
    - 强制使用IPv4协议
    - 即使主机有IPv6地址也使用IPv4
    - IPv4网络测试

18. **-6 强制IPv6模式**
    - 强制使用IPv6协议
    - 即使主机有IPv4地址也使用IPv6
    - IPv6网络测试

19. **-m mark 设置包标记**
    - 设置发送包的mark值
    - 用于策略路由和防火墙规则
    - 网络流量标识

20. **-M pmtudisc 路径MTU发现**
    - 设置路径MTU发现策略
    - 支持do/dont/want选项
    - 网络MTU测试

### 接口和地址功能

21. **-I interface 指定网络接口**
    - 从指定的网络接口发送包
    - 支持接口名称（如eth0）或IP地址
    - 多网卡环境测试

22. **-T tstamp 时间戳选项**
    - 设置IP时间戳选项
    - 支持tsonly/tsandaddr/tsprespec
    - 精确的网络延迟测量

